{% extends "base.html" %}

{% block title %}ç€è¦½åœ˜è³¼ - åœ˜è³¼å¹³å°{% endblock %}
{% block page_title %}æ¢ç´¢ç†±é–€åœ˜è³¼{% endblock %}

{% block content %}
<!-- Page Heading -->
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <div>
        <h1 class="h3 mb-0 text-gray-800">ğŸ›’ ç†±é–€åœ˜è³¼</h1>
        <p class="text-gray-600 mt-2">å¿«ä¾†åƒåŠ é€²è¡Œä¸­çš„åœ˜è³¼ï¼Œä¸€èµ·çœæ›´å¤šï¼</p>
    </div>
    <a href="{{ url_for('create_group') }}" class="d-none d-sm-inline-block btn btn-primary shadow-sm">
        <i class="fas fa-plus-circle fa-sm text-white-50"></i> æˆ‘è¦é–‹åœ˜
    </a>
</div>

<!-- Mobile Create Button -->
<div class="d-sm-none mb-3">
    <a href="{{ url_for('create_group') }}" class="btn btn-primary btn-block">
        <i class="fas fa-plus-circle"></i> æˆ‘è¦é–‹åœ˜
    </a>
</div>

<!-- Content Row -->
<div class="row">
    {% if groups %}
        {% for group in groups %}
        <div class="col-xl-4 col-md-6 mb-4">
            <div class="card group-card shadow h-100">
                <!-- Product Image -->
                {% if group.product.image_url %}
                <div class="card-image-container">
                    <img src="{{ group.product.image_url }}" alt="{{ group.product.name }}" class="product-image">
                    {% if group.progress_percentage >= 80 %}
                    <span class="hot-badge">ğŸ”¥ ç†±è³£ä¸­</span>
                    {% endif %}
                </div>
                {% endif %}
                
                <div class="card-body">
                    <!-- Category & Product Name -->
                    <div class="mb-2">
                        <span class="category-badge">
                            <i class="fas fa-tag"></i> {{ group.product.name }}
                        </span>
                    </div>
                    
                    <!-- Group Name -->
                    <h5 class="font-weight-bold text-gray-800 mb-2">
                        {{ group.name }}
                    </h5>
                    
                    <!-- Leader Info -->
                    <div class="text-sm text-gray-600 mb-3">
                        <i class="fas fa-user-circle"></i> 
                        åœ˜é•·ï¼š<strong>{{ group.leader.name }}</strong>
                    </div>
                    
                    <!-- Price -->
                    <div class="mb-3">
                        <span class="price-tag-small">
                            <i class="fas fa-dollar-sign"></i>{{ group.product.price }}
                        </span>
                        <span class="text-muted">/ ä»¶</span>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <small class="text-muted">
                                <i class="fas fa-users"></i> åœ˜è³¼é€²åº¦
                            </small>
                            <small class="font-weight-bold text-primary">
                                {{ group.progress_percentage }}%
                            </small>
                        </div>
                        <div class="progress progress-group">
                            <div class="progress-bar bg-{% if group.progress_percentage >= 100 %}success{% elif group.progress_percentage >= 70 %}info{% else %}primary{% endif %}" 
                                 role="progressbar" 
                                 style="width: {{ group.progress_percentage }}%" 
                                 aria-valuenow="{{ group.current_quantity }}" 
                                 aria-valuemin="0" 
                                 aria-valuemax="{{ group.target_quantity }}">
                                {{ group.current_quantity }}/{{ group.target_quantity }}
                            </div>
                        </div>
                        <small class="text-muted">
                            {% if group.remaining_slots > 0 %}
                                é‚„å‰© <strong class="text-danger">{{ group.remaining_slots }}</strong> å€‹åé¡
                            {% else %}
                                <strong class="text-success">âœ“ å·²é¡æ»¿</strong>
                            {% endif %}
                        </small>
                    </div>
                    
                    <!-- Deadline -->
                    <div class="mb-3 info-item">
                        <small class="text-muted">
                            <i class="fas fa-clock"></i> æˆªæ­¢æ™‚é–“
                        </small>
                        <div class="font-weight-bold text-dark">
                            {{ group.deadline.strftime('%mæœˆ%dæ—¥ %H:%M') }}
                        </div>
                    </div>
                    
                    <!-- Action Button -->
                    <a href="{{ url_for('group_detail', group_id=group.id) }}" 
                       class="btn btn-primary btn-block btn-join">
                        <i class="fas fa-shopping-cart"></i> æŸ¥çœ‹è©³æƒ… & ç«‹å³è·Ÿåœ˜
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="col-12">
            <div class="card shadow mb-4">
                <div class="card-body empty-state">
                    <i class="fas fa-shopping-cart"></i>
                    <h4 class="text-gray-700 mb-3">ç›®å‰æ²’æœ‰é€²è¡Œä¸­çš„åœ˜è³¼</h4>
                    <p class="text-gray-500 mb-4">
                        é‚„æ²’æœ‰äººé–‹åœ˜ï¼Œæˆç‚ºç¬¬ä¸€å€‹ç™¼èµ·åœ˜è³¼çš„äººå§ï¼<br>
                        é‚€è«‹æœ‹å‹ä¸€èµ·è³¼è²·ï¼Œäº«å—æ›´å„ªæƒ çš„åƒ¹æ ¼ ğŸ‰
                    </p>
                    <a href="{{ url_for('create_group') }}" class="btn btn-primary btn-lg">
                        <i class="fas fa-plus-circle"></i> ç«‹å³é–‹åœ˜
                    </a>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<!-- Info Banner -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card bg-gradient-primary text-white shadow">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h5 class="text-white mb-2">
                            <i class="fas fa-lightbulb"></i> å¦‚ä½•åƒèˆ‡åœ˜è³¼ï¼Ÿ
                        </h5>
                        <p class="mb-0">
                            1ï¸âƒ£ é¸æ“‡å–œæ­¡çš„å•†å“ â†’ 2ï¸âƒ£ é»æ“Šã€Œè·Ÿåœ˜ã€åŠ å…¥ â†’ 3ï¸âƒ£ ç­‰å¾…åœ˜è³¼æˆåŠŸ â†’ 4ï¸âƒ£ æ”¶åˆ°å•†å“é€šçŸ¥
                        </p>
                    </div>
                    <div class="col-md-4 text-center">
                        <a href="{{ url_for('create_group') }}" class="btn btn-light btn-lg mt-3 mt-md-0">
                            <i class="fas fa-plus"></i> æˆ‘ä¹Ÿè¦é–‹åœ˜
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
